<!-- Bootstrap 5 CSS + Icons (for accessibility modal) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
      integrity="sha256-pdY4ejLKO67E0CM2tbPtq1DJ3VGDVVdqAR6j3ZwdiE4=" crossorigin="anonymous">

<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']]
    }
  };
</script>
<script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- Bootstrap JS Bundle (for accessibility modal) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
        crossorigin="anonymous" defer></script>

<!-- Accessibility Theme Toggle -->
<style>
/* Accessibility Floating Button */
#accessibility-toggle-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 1000;
  border-radius: 50%;
  width: 42px;
  height: 42px;
  padding: 0;
  box-shadow: 0 2px 6px rgba(0,0,0,0.12);
  border: 2px solid transparent;
  background-color: #6c757d;
  color: white;
  cursor: pointer;
  transition: all 0.2s ease;
}

#accessibility-toggle-btn:hover {
  background-color: #5a6268;
  transform: scale(1.05);
}

#accessibility-toggle-btn:focus {
  outline: 2px solid #0d6efd;
  outline-offset: 2px;
}

#accessibility-toggle-btn .bi {
  font-size: 1.1rem;
}

/* High Contrast Themes */
body[data-contrast="dark"] {
  --body-background-color: #000000 !important;
  --body-text-color: #ffffff !important;
  --body-heading-color: #ffffff !important;
  --border-color: #ffffff !important;
  --link-color: #FFD60A !important;
  --nav-background-color: #1a1a1a !important;
  --nav-text-color: #ffffff !important;
  --sidebar-background-color: #1a1a1a !important;
  --sidebar-text-color: #ffffff !important;
  --code-background-color: #2d2d2d !important;
}

body[data-contrast="light"] {
  --body-background-color: #ffffff !important;
  --body-text-color: #000000 !important;
  --body-heading-color: #000000 !important;
  --border-color: #000000 !important;
  --link-color: #0000ff !important;
  --nav-background-color: #ffffff !important;
  --nav-text-color: #000000 !important;
  --sidebar-background-color: #f8f9fa !important;
  --sidebar-text-color: #000000 !important;
  --code-background-color: #f8f9fa !important;
}

/* Modal Styles */
.accessibility-modal .modal-content {
  border: none;
  border-radius: 0.25rem;
  box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.12);
}

.accessibility-modal .modal-header {
  background-color: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
}

.accessibility-modal .modal-body {
  padding: 1rem;
}

.accessibility-modal .btn-group .btn {
  border-radius: 0.3125rem;
}

.accessibility-modal .form-check-input:focus {
  box-shadow: 0 0 0 0.2rem rgba(59, 130, 246, 0.25);
}
</style>

<script>
// Accessibility Theme Manager for Just the Docs
(function() {
  'use strict';

  // Theme management
  const THEMES = {
    default: { label: 'Default', contrast: null },
    dark: { label: 'Dark', contrast: 'dark' },
    light: { label: 'Light', contrast: 'light' }
  };

  function getStoredTheme() {
    return localStorage.getItem('jtd-theme') || 'default';
  }

  function setStoredTheme(theme) {
    localStorage.setItem('jtd-theme', theme);
  }

  function applyTheme(theme) {
    const contrast = THEMES[theme].contrast;
    if (contrast) {
      document.body.setAttribute('data-contrast', contrast);
    } else {
      document.body.removeAttribute('data-contrast');
    }

    // Update radio buttons
    const radio = document.querySelector(`input[name="accessibilityTheme"][value="${theme}"]`);
    if (radio) {
      radio.checked = true;
    }
  }

  function initializeTheme() {
    const storedTheme = getStoredTheme();
    applyTheme(storedTheme);

    // Theme change handlers
    document.querySelectorAll('input[name="accessibilityTheme"]').forEach(radio => {
      radio.addEventListener('change', function() {
        if (this.checked) {
          const theme = this.value;
          setStoredTheme(theme);
          applyTheme(theme);
        }
      });
    });
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeTheme);
  } else {
    initializeTheme();
  }

  // Initialize Bootstrap tooltips if available
  if (typeof bootstrap !== 'undefined' && bootstrap.Tooltip) {
    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl);
    });
  }

})();
</script>
